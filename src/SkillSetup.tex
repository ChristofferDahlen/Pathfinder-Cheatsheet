\NewDocumentCommand{\TextOutline}{O{1pt} O{m} O{0ex} m O{white} O{black} }{%
    \edef\OBoxAlign{#2}%
    \IfBlank{#2}{%
        \@ifundefined{SkillAlign}{}{%
            \edef\OBoxAlign{\SkillAlign}%
        }%
    }%
    \begin{adjustbox}{valign=\OBoxAlign, raise=#3}%
    \begin{tikzpicture}%
        \draw (0,0) node[anchor=south, outer sep=0, inner sep=0, align=center] {%
            \textpdfrender{%
                TextRenderingMode=FillStrokeClip,%
                LineCapStyle=ProjectingSquare,
                LineJoinStyle=Bevel,%
                LineWidth=#1,%
                StrokeColor=#6,%
                FillColor=#5%
            }{#4\par}%
        };
        \draw [use as bounding box] (0, 0) node[outer sep=0, inner sep=0, anchor=south, align=center, text=#5] {%
            #4\par%
        };%
    \end{tikzpicture}%
    \end{adjustbox}%
}


\NewDocumentCommand{\IBox}{O{0.8} O{IColor} O{IColorBorder} m O{} O{}}{%
    \edef\IBoxAlign{B}%
    \edef\IOffset{-0.2ex}%
    \IfBlankElse{#5}{%
        \@ifundefined{SkillAlign}{%
        }{%
            \edef\IBoxAlign{\SkillAlign}%
            \edef\IOffset{0ex}%
        }%
    }{
        \edef\DCBoxAlign{#2}
        \edef\DCOffset{#6}%
    }%
    \begin{adjustbox}{valign=\IBoxAlign, raise=\IOffset}%
    \tcbox[%
        arc=0.0ex,
        colframe=#3,
        colback=#2,
        right skip=0ex,
        left skip=0.1ex,
        size=fbox,
        top =0.2ex,
        bottom=0.2ex,
        left=0.0ex,
        right=0.0ex,
        boxrule=0.2pt,
        boxsep=0.1ex]{\textcolor{IColorText}{\scalefont{#1}\textbf{#4}}}%
    \end{adjustbox}%
}

\NewDocumentCommand{\LVL}{m}{{\rmfamily\scalefont{1.1}\IBox{\MSC{Lv}L \Numb{#1}}}}%

\newcommand{\TimeBox}[1]{%
    \tcbox[on line,
        box align=base,
        arc=0.0ex,
        colframe=TimeColorBorder,
        colback=TimeColor,
        right skip=0ex,
        left skip=0.1ex,
        size=fbox,
        top =0.2ex,
        bottom=0.2ex,
        left=0.3ex,
        right=0.3ex,
        boxrule=0.2pt,
        boxsep=0.1ex]{\textcolor{TimeColorText}{\textbf{#1}}}%
}

\NewDocumentCommand{\Time}{O{} m m O{}}{{\scriptsize\scalefont{0.6}%
\IfNotBlank{#1}{#1\xspace}%
\IfNotBlank{#2}{{\Numb{#2}}\xspace}%
#3%
\IfNotBlank{#4}{#4}%
}}
%\NewDocumentCommand{\Time}{O{} m m O{}}{{\scriptsize\scalefont{0.5}%
%    \IfNotBlank{#1}{#1\xspace}%
%    \IfNotBlank{#2}{{\kirsty#2\xspace}}%
%    \IfNotBlank{#3}{#3\xspace}#4}}
\NewDocumentCommand{\TimeMin}{m O{}}{\TimeBox{\Time{#1}{\MSC{Min}}[#2]}}
\NewDocumentCommand{\TimeHour}{m O{}}{\TimeBox{\Time{#1}{H}[#2]}}
\NewDocumentCommand{\TimeDay}{m O{}}{\TimeBox{\Time{#1}{\MSC{Day}}[#2]}}
\NewDocumentCommand{\TimeDays}{m O{}}{\TimeBox{\Time{#1}{\MSC{Days}}[#2]}}
\NewDocumentCommand{\TimeWeek}{m O{}}{\TimeBox{\Time{#1}{\MSC{Week}}[#2]}}
\NewDocumentCommand{\TimeWeeks}{m O{}}{\TimeBox{\Time{#1}{\MSC{Weeks}}[#2]}}
\NewDocumentCommand{\TimeDaily}{}{\TimeBox{\Time{\MSC{Daily}}}}

\NewDocumentCommand{\TimeHex}{O{} m}{\TimeBox{\Time[#1]{#2}{\MSC{Hex Act.}}}}


\NewDocumentEnvironment{entryBox}{m m O{t}}{%
    \scalefont{1.2}
    \adjustbox{valign=#3}\bgroup
    \rmfamily
    \bfseries
    \def\SkillAlign{M}%
    \tcolorbox[%
        capture=hbox,
        on line,
        halign=center,
        valign=center,
        colframe=#2,
        colback=#1,
        right skip=0.1ex,
        left skip=0pt,
        size=fbox,
        sharp corners,
        boxrule=0.2ex,
        boxsep=0.1ex,
        height from=2.4ex to 2.6ex,
        top=0.1ex,
        bottom=0.1ex,
        left=0.0ex,
        right=0.0ex,
        box align=base]
    }{%
    \BodyFont
    \endtcolorbox%
    \egroup%
}

\newcommand{\tagBox}[2]{%
{\scalefont{0.8}%
\begin{adjustbox}{valign=B, raise=-0.4ex}%
    \tcbox[%
        colframe=tagFieldColor,
        colback=#2,
        on line,
        box align=base,
        right skip=0.1ex,
        left skip=0.1ex,
        size=fbox,
        sharp corners,
        boxrule=0.1ex,
        boxsep=0.2ex,
        top=0.1ex,
        bottom=0.1ex,
        ]{\sffamily{\TextOutline[0.5pt][M]{\textbf{\MSC{#1}}}}}%
\end{adjustbox}%
}%
    }

\NewDocumentEnvironment{SKBox}{}{%
    \entryBox{SkillColor}{SkillColorBorder}%
        }{%
    \endentryBox%
}%


\NewDocumentCommand{\SkillTextOutline}{m O{}}{\TextOutline[1pt][#2]{#1}}

\NewDocumentCommand{\SkillBox}{m O{} O{}}{%
    \begin{SKBox}%
    \SkillTextOutline{\MSC{#1}}[M]%
        \IfNotBlank{#2}{\,\applytoeveryword{#2}{\!\IBox{##1}[M]}}#3%
    \end{SKBox}%
}

\NewDocumentCommand{\SkillvsBox}{m O{} O{} m O{}}{%
    \begin{SKBox}%
        \SkillTextOutline{\MSC{#1}}[M]%
        \IfNotBlank{#2}{\,\applytoeveryword{#2}{\!\IBox{##1}[M]}}#3%
        \SkillTextOutline{%
                {\scalefont{0.6}\,vs\,}\vphantom{I}\MSC{#4}}[M]%
        #5%
    \end{SKBox}%
}

\NewDocumentCommand{\Feat}{O{}}{%
    \begin{entryBox}{FeatColor}{FeatColorBorder}%
        \TextOutline[1pt][M]{\textbf{\MSC{Feat}}#1}[FeatColorText]%
        \end{entryBox}%
}

\NewDocumentCommand{\Rare}{O{}}{%
    \begin{entryBox}{RareColor}{RareColorBorder}%
        \TextOutline[1pt][M]{\textbf{\MSC{Feat}}#1}[RareColorText]%
    \end{entryBox}%
}

\NewDocumentCommand{\Acrobatics}{O{} O{} O{}}{\SkillBox{Acrobatics}[#1][#2]}

\NewDocumentCommand{\Deception}{O{} O{} O{}}{\SkillBox{Deception}[#1][#2]}
\NewDocumentCommand{\Crafting}{O{} O{} O{}}{\SkillBox{Crafting}[#1][#2]}

\NewDocumentCommand{\Perception}{O{} O{}}{\SkillBox{Perception}[#1][#2]}
\NewDocumentCommand{\Stealth}{O{} O{}}{\SkillBox{Stealth}[#1][#2]}
\NewDocumentCommand{\Survival}{O{} O{}}{\SkillBox{Survival}[#1][#2]}
\NewDocumentCommand{\Athletics}{O{} O{}}{\SkillBox{Athletics}[#1][#2]}
\NewDocumentCommand{\Thievery}{O{} O{}}{\SkillBox{Thievery}[#1][#2]}
\NewDocumentCommand{\Diplomacy}{O{} O{}}{\SkillBox{Diplomacy}[#1][#2]}
\NewDocumentCommand{\Performance}{O{} O{}}{\SkillBox{Performance}[#1][#2]}
\NewDocumentCommand{\Nature}{O{} O{}}{\SkillBox{Nature}[#1][#2]}
\NewDocumentCommand{\Society}{O{} O{}}{\SkillBox{Society}[#1][#2]}
\NewDocumentCommand{\Arcana}{O{} O{}}{\SkillBox{Arcana}[#1][#2]}
\NewDocumentCommand{\Piloting}{O{} O{}}{\SkillBox{Piloting}[#1][#2]}

\NewDocumentCommand{\Medicine}{O{} O{}}{\SkillBox{Medicine}[#1][#2]}


\NewDocumentCommand{\MagicalSkill}{O{} O{}}{\SkillBox{Magical Skill}[#1][#2]}
\NewDocumentCommand{\VariousKnowledge}{O{} O{}}{\SkillBox{Various Knowledge}[#1][#2]}

\NewDocumentCommand{\AthleticsFortitude}{O{} O{} O{}}{\SkillvsBox{Athletics}[#1][#2]{Fortitude}[#3]}
\NewDocumentCommand{\AthleticsReflex}{O{} O{} O{}}{\SkillvsBox{Athletics}[#1][#2]{Reflex}[#3]}
\NewDocumentCommand{\AcrobaticsReflex}{O{} O{} O{}}{\SkillvsBox{Acrobatics}[#1][#2]{Reflex}[#3]}
\NewDocumentCommand{\DeceptionWill}{O{} O{} O{}}{\SkillvsBox{Deception}[#1][#2]{Will}[#3]}
\NewDocumentCommand{\InitimidationWill}{O{} O{} O{}}{\SkillvsBox{Intimidation}[#1][#2]{Will}[#3]}
\NewDocumentCommand{\DiplomacyWill}{O{} O{} O{}}{\SkillvsBox{Diplomacy}[#1][#2]{Will}[#3]}
\NewDocumentCommand{\PerceptionStealth}{O{} O{} O{}}{\SkillvsBox{Perception}[#1][#2]{Stealth}[#3]}


\NewDocumentCommand{\DC}{O{} O{} O{}}{%
    \ifthenelse{\equal{#1}{}}{\Typetv{DC}}{\DCBox{#1}[][#2][#3]}%
}

\NewDocumentCommand{\DCActBox}{m O{} O{0ex}}{%
    \edef\DCBoxAlign{B}%
    \edef\DCOffset{-0.2ex}%
    \IfBlankElse{#2}{%
        \@ifundefined{SkillAlign}{%
        }{%
            \edef\DCBoxAlign{\SkillAlign}%
            \edef\DCOffset{0ex}%
        }%
    }{
        \edef\DCBoxAlign{#2}
        \edef\DCOffset{#3}%
    }%
    \begin{adjustbox}{valign=\DCBoxAlign, raise=\DCOffset}%
        \tcbox[
            arc=0.0ex,
            colframe=DCColor,
            colback=DCColorBorder,
            halign=center,
            valign=center,
            right skip=0ex,
            left skip=0.1ex,
            size=fbox,
            top =0.2ex,
            bottom=0.2ex,
            left=0.0ex,
            right=0.0ex,
            boxrule=0.2pt,
            bottomrule=0pt,
            toprule=0pt,
            boxsep=0.1ex]{\TextOutline[1pt][M]{{\scalefont{0.9}#1}}}%
    \end{adjustbox}%
}
\NewDocumentCommand{\DCBox}{O{} m O{} O{}}{%
\DCActBox{%
    \IfNotBlank{#1}{#1\,}%
    \DC%
    \IfNotBlank{#2}{\,\scalefont{1}\Numb{#2}}%
    \IfNotBlank{#3}{\,#3}}[#4]}%

